{{ define "main" }}
  {{ .Scratch.Set "scope" "list" }}
  
  {{/* 共通背景パーツの挿入 */}}
  {{ partial "background-hero.html" . }}

  <div class="relative mx-auto py-16 flex flex-col lg:flex-row lg:items-start">
    {{/* Main Content Area */}}
    <div class="flex-grow min-w-0">
      {{/* Header */}}
      <header class="text-center lg:text-left">
        {{ if .Params.showBreadcrumbs | default (site.Params.list.showBreadcrumbs | default false) }}
        {{ partial "breadcrumbs.html" . }}
        {{ end }}
        <h1 class="mt-5 text-4xl font-extrabold text-neutral-800 dark:text-neutral-100 drop-shadow-md">
          {{ .Title }}
        </h1>
        <div class="mt-1 mb-8 text-base text-neutral-600 dark:text-neutral-400">
          {{ partial "article-meta/list.html" (dict "context" . "scope" "single") }}
        </div>
        </header>

      {{/* Description (markdown content) */}}
      <section class="prose dark:prose-invert max-w-none mb-12 text-center lg:text-left">
        <div class="inline-block text-left w-full max-w-prose">
          {{ .Content }}
        </div>
      </section>

      {{/* Article Grid */}}
      <div class="recent-articles-section text-left">
        {{ if gt .Pages 0 }}
        {{ $cardView := .Params.cardView | default (site.Params.list.cardView | default false) }}
        {{ $groupByYear := .Params.groupByYear | default (site.Params.list.groupByYear | default false) }}
      
        {{ if $cardView }}
            <section class="w-full grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
              {{ range .Paginator.Pages }}
              {{ partial "article-link/card.html" . }}
              {{ end }}
              </section>
              {{ else }}
              <section class="space-y-10 w-full">
                {{ range .Paginator.Pages }}
              {{ partial "article-link/simple.html" . }}
              {{ end }}
              </section>
              {{ end }}
              {{ else }}
          <section class="mt-10 prose dark:prose-invert text-center lg:text-left">
            <p class="py-8 border-t border-neutral-200 dark:border-neutral-700">
              <em>{{ i18n "list.no_articles" | emojify }}</em>
            </p>
          </section>
          {{ end }}
          </div>

      {{ partial "pagination.html" . }}
    </div>
    
    {{/* Sidebar Area (Desktop: Right, Mobile: Bottom) */}}
    <aside class="w-full lg:w-1/5 lg:ps-8 mt-12 lg:mt-0 flex-shrink-0">
      <div class="lg:sticky lg:top-10">
        {{ partial "popular-articles-sidebar.html" . }}
        {{ partial "categories-sidebar.html" . }}
        {{ partial "imobile-ad.html" . }}
      </div>
    </aside>
  </div>
{{ end }}
