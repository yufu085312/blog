---
title: 'React Server Componentsの深刻な脆弱性（CVE-2025-55182）を徹底解説<br> 〜RCE・DoS・ソースコード漏洩の実例と対策〜'
date: 2025-12-20T17:32:04+09:00
draft: false
description: "React Server Components（RSC）の脆弱性CVE-2025-55182を実例付きで徹底解説。RCE（リモートコード実行）・DoS・ソースコード漏洩の仕組み、PoCの危険性、影響範囲、再現ケース、Cloudflare環境でのリスク、具体的な対策とパッチ適用まで網羅したセキュリティガイド。"
summary: "React Server Componentsの深刻な脆弱性CVE-2025-55182を分かりやすく解説。RCE・DoS・ソースコード漏洩のリスクと攻撃の仕組み、Cloudflare等の実運用環境での影響、最新パッチと具体的な対策をまとめた実践セキュリティガイド。"
categories: ["セキュリティ","Web開発"]
tags: ["React","RSC","CVE","セキュリティ"]
showSummary: true
showHero: true
# heroImage: "featured.webp"

---

{{< lead >}}
2025年12月、React Server Components（RSC）周辺エコシステムに複数の深刻な脆弱性が報告されました。中でもCVE-2025-55182は「信頼できないデータのデシリアライズ」に起因するRCE（任意コード実行）の可能性があるCriticalな脆弱性として注目されています。本記事では仕組み・影響範囲・攻撃シナリオ・観測された悪用例・緩和策・恒久対策をエンジニア視点で整理します。
{{< /lead >}}

## 1. CVE-2025-55182 概要

- React Server Componentsで**信頼できないデータをデシリアライズする際の処理不備**から発生。
- 悪用により**リモートから任意コード実行**（RCE）される可能性がある。
- Next.jsやParcel、TurbopackなどRSC関連パッケージも影響を受ける場合がある。

## 2. 影響を受けるシステム

### 対象パッケージ（脆弱バージョン）

```
react-server-dom-webpack 19.0 / 19.1.0 / 19.1.1 / 19.2.0
react-server-dom-parcel  19.0 / 19.1.0 / 19.1.1 / 19.2.0
react-server-dom-turbopack 19.0 / 19.1.0 / 19.1.1 / 19.2.0
```

### 修正済みバージョン

```
react-server-dom-webpack 19.0.1 / 19.1.2 / 19.2.1
react-server-dom-parcel  19.0.1 / 19.1.2 / 19.2.1
react-server-dom-turbopack 19.0.1 / 19.1.2 / 19.2.1
```

## 3. 脆弱性の仕組み（なぜRCEが可能なのか）

- RSCはクライアントとサーバ間でコンポーネントのシリアライズ結果（Flightレスポンス）をやり取りする。
- その際、JSONライクな構造データをパース・復元するプロセスが存在する。
- ユーザー入力や改ざん可能なデータが混入すると、安全でないオブジェクト構造を復元してしまい、意図しないコードパスが実行される可能性がある。

結果として、悪意あるシリアライズデータが注入されるとRCEに発展するリスクが生じる。

## 4. 想定される攻撃シナリオ

| 攻撃種別                         | 悪用方法                       | 想定被害                         |
|----------------------------------|-------------------------------|----------------------------------|
| RCE（CVE-2025-55182）           | 細工したシリアライズデータ送信 | 任意コード実行・バックドア設置   |
| ソースコード漏洩（CVE-2025-55183）| RSCレスポンスからの情報抽出   | 事業ロジックや機密コードの流出   |
| DoS（CVE-2025-55184 / 67779）   | 不正な再帰構造データの送信     | サーバクラッシュ・サービス停止   |

## 5. 実際の悪用例（観測された攻撃）

- 国内のRSC/Next.jsセルフホスト環境で、デシリアライズ処理を悪用したコード実行の兆候が観測されている。
- ミドルウェアやRSC通信を迂回し、バックドアマルウェア（ZnDoorやその亜種）の設置につながるケースが確認されている。
- ソースコード抽出を伴う攻撃も同時期に観測され、二次被害が懸念される。

## 6. すぐできる緩和策（ワークアラウンド）

アップデートがすぐにできない場合でも、以下の一時対策でリスクを低減できます。

### ✅ 外部リクエストに RSC内部ヘッダーを含むものを遮断

- リバースプロキシ（例: Nginx, Caddy, Cloudflare WAF）で `x-middleware-subrequest` など内部ヘッダー付きのリクエストをブロックする。
- フロント段で**RSC通信データの検証フィルタ**を実装する。
- Middlewareだけに認証を依存させず、**ハンドラ側で二重チェック**を行う。

これらは恒久対応ではないが、攻撃表面を削ぐ有効な手段となる。

## 7. 恒久的な対策（依存アップデート + セキュリティ設計）

### 🔧 依存アップデート

```bash
npm i react-server-dom-webpack@19.2.1
npm i next@15.2.3  # Next.jsもMiddleware bypass系CVEの影響範囲を避けるため最新推奨
```

パッケージ更新後は、ステージング環境での動作確認とE2Eテストを必ず行ってください。

### 🛡 設計レベルの改善

- 認証・認可は1箇所に依存しない（多層防御）。
- サーバ側でトークン検証・入力検証を必ず行う。
- RSCのレスポンス内容をログやアナリティクスで監視する。
- 依存のCVEアラートを常時チェック（Dependabotなど）する。

## 8. 記事のまとめ

- RSC関連のデシリアライズ処理には**RCE / DoS / ソースコード漏洩の複合リスク**が存在する。
- すぐにできる対策は**内部ヘッダーや改ざん可能データの遮断と二重検証**。
- 根本解決は**react-server-dom-* と Next.js の最新パッチ適用**である。
- 依存やミドルウェアの**単一認証設計は危険**という教訓を再確認すべき。
