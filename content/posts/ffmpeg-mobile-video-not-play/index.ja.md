---
title: "FFmpegで動画がPCでは再生できるのにモバイルで失敗した話"
date: 2026-02-04T23:32:03+09:00
draft: false
description: "FFmpegで生成した動画がPCでは再生できるのに、モバイル端末では再生されない原因を実体験ベースで解説。ビットレートが高すぎることが原因だった事例と、Go×FFmpegでの圧縮・保存時の対策実装を紹介します。"
summary: "FFmpegで生成した動画がPCでは再生できるのに、スマホではエラーになる原因はビットレートが高すぎることでした。実際に遭遇した問題と、GoでFFmpegを使ってビットレートを下げる対応を行った体験談をまとめます。"
categories: ["動画処理", "FFmpeg", "バックエンド"]
tags: ["FFmpeg", "Go", "動画", "ビットレート", "モバイル", "トラブルシューティング"]
showSummary: true
showHero: true
---

{{< lead >}}
**PCでは普通に再生できる動画が、スマホだと再生されない。**

しかも、  
- ファイル自体は存在している  
- エラーも特に出ていない  
- 再生ボタンを押すと一瞬で止まる  

そんな状況にハマりました。

本記事では、**Go × FFmpeg** を使った動画処理の実装中に実際に遭遇した  
「モバイル端末で動画が再生されない問題」について、  
**原因と解決までの流れを実体験ベースで解説**します。

※ 結論から言うと、原因は **FFmpegで保存した動画のビットレートが高すぎたこと**でした。

{{< /lead >}}

---

## 発生した問題

### 状況

- サーバー側で FFmpeg を使って動画を保存
- PC（Chrome / Safari）では問題なく再生可能
- **iPhone / Android では再生されない**

ブラウザ上では特にエラーは出ず、

- 再生ボタンを押す
- すぐに停止する
- 黒画面のまま

という状態でした。

---

## 最初に疑ったこと（結論：違った）

当初は以下を疑いました。

- コーデック（H.264 / H.265）
- mp4コンテナの問題
- MIME Type の設定
- `<video>` タグの書き方

しかし、  
**どれも原因ではありませんでした。**

---

## 本当の原因：ビットレートが高すぎた

結論から言うと、  
**FFmpegで保存した動画のビットレートが高すぎた**ことが原因でした。

### なぜPCでは再生できたのか

- PCはCPU・メモリに余裕がある
- 高ビットレートでもデコードできる
- ネットワーク帯域も比較的安定

### なぜモバイル（特にiOS Safari）では再生できなかったのか

- モバイル端末はデコード性能が低い
- ブラウザが再生を諦める
- 特に **iOS Safari は制限が厳しい**

結果として、  
**再生できない動画ファイルが生成されていた**状態でした。

---

## 問題のFFmpeg設定（改善前）

当時の実装では、  
FFmpegに対して明示的なビットレート指定をしていませんでした。

```bash
ffmpeg -i input.mp4 -c:v libx264 output.mp4
```

この場合、

* 元動画のビットレートを引き継ぐ
* 場合によっては **非常に重い動画** になる

という問題があります。

---

## 対策：保存時に圧縮し、ビットレートを下げる

### モバイル向けに意識したポイント

* H.264（libx264）を使用
* ビットレートを明示的に指定
* 音声も軽量化

---

### 改善前と改善後の違い

- 改善前：元動画のビットレートをそのまま使用
- 改善後：モバイル向けにビットレートを明示的に制限

### 改善後のFFmpegコマンド例

```bash
ffmpeg -i input.mp4 \
  -c:v libx264 \
  -profile:v baseline \
  -level 3.0 \
  -b:v 1500k \
  -maxrate 1500k \
  -bufsize 3000k \
  -c:a aac \
  -b:a 128k \
  output.mp4
```

### ポイント解説

* `-b:v 1500k`
  → モバイルでも再生しやすいビットレート
* `baseline / level 3.0`
  → 古い端末・Safari対策
* `-b:a 128k`
  → 音声も軽量化

---

## GoでのFFmpeg実装例

実際には Go から `exec.Command` で FFmpeg を呼び出していました。

```go
cmd := exec.Command(
    "ffmpeg",
    "-i", inputPath,
    "-c:v", "libx264",
    "-profile:v", "baseline",
    "-level", "3.0",
    "-b:v", "1500k",
    "-maxrate", "1500k",
    "-bufsize", "3000k",
    "-c:a", "aac",
    "-b:a", "128k",
    outputPath,
)

err := cmd.Run()
if err != nil {
    log.Fatalf("ffmpeg error: %v", err)
}
```

この修正後、
**モバイル端末でも問題なく再生できるようになりました。**

---

## モバイル向けの推奨ビットレート目安

| 解像度   | 推奨ビットレート      | 用途 |
| ----- | ------------- | ----- |
| 480p  | 800〜1000kbps  | SNS / 軽量配信 |
| 720p  | 1200〜2000kbps | Web埋め込み |
| 1080p | 3000kbps以下    | 高画質（非推奨モバイル） |

※ Safari 対応を考えるなら **控えめが正解** です。

---

## 同じ問題にハマりやすいケース

* サーバー側で動画を再エンコードしている
* 元動画が高画質・高ビットレート
* モバイル検証を後回しにしている
* PCだけで動作確認している

👉 **「再生できる＝正しい動画」ではない**点に注意が必要です。

---

## まとめ

FFmpegで生成した動画が、

* PCでは再生できる
* モバイルでは再生できない

という場合、
**ビットレートをまず疑うべき**です。

特に、

* Go × FFmpeg
* サーバーサイドで動画を保存・変換
* モバイル対応が必要

という構成では、
**保存時のFFmpeg設定がそのままUXに直結**します。

同じような問題で悩んでいる方の参考になれば幸いです。

※ なお、モバイル再生ではビットレート以外にも  
`moov atom` の位置（faststart）が影響するケースがあります。  
詳しくは別記事で解説しています。
